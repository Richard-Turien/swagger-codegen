// APIHelper.swift
//
// Generated by swagger-codegen
// https://github.com/swagger-api/swagger-codegen
//

import Foundation

class APIHelper {

    static let numberFormatter = NumberFormatter()

    static func rejectNil(_ source: [String:Any?]) -> [String:Any]? {
        var destination = [String:Any]()
        for (key, nillableValue) in source {
            if let value: Any = nillableValue {
                destination[key] = value
            }
        }

        if destination.isEmpty {
            return nil
        }
        return destination
    }

    static func rejectNilHeaders(_ source: [String:Any?]) -> [String:String] {
        var destination = [String:String]()
        for (key, nillableValue) in source {
            if let value: Any = nillableValue {
                destination[key] = "\(value)"
            }
        }
        return destination
    }

    static func convertBoolToString(_ source: [String: Any]?) -> [String:Any]? {
        guard let source = source else {
            return nil
        }
        var destination = [String:Any]()
        let theTrue = NSNumber(value: true as Bool)
        let theFalse = NSNumber(value: false as Bool)
        for (key, value) in source {
            switch value {
            case let x where x as? NSNumber === theTrue || x as? NSNumber === theFalse:
                destination[key] = "\(value as! Bool)" as Any?
            default:
                destination[key] = value
            }
        }
        return destination
    }

    static func valueToString(_ valueBox: Any?) -> String {
        guard let value = valueBox else {
            return "\(valueBox)"
        }

        switch value {
        case is Double,
            is Float,
            is Int,
            is Int8,
            is Int16,
            is Int32,
            is Int64,
            is UInt,
            is UInt8,
            is UInt16,
            is UInt32,
            is UInt64:
                return numberFormatter.string(for: value) ?? "\(value)"
        default:
            return "\(value)"
        }
    }

    static func mapValuesToQueryItems(values: [String:Any?]) -> [URLQueryItem]? {
        let returnValues = values
            .filter { $0.1 != nil }
            .map { (item: (_key: String, _value: Any?)) -> [URLQueryItem] in
                if let value = item._value as? Array<String> {
                    return value.map { (v) -> URLQueryItem in
                        URLQueryItem(
                            name: item._key,
                            value: v
                        )
                    }
                } else {
                    return [URLQueryItem(
                        name: item._key,
                        value: valueToString(item._value!)
                    )]
                }
            }
            .flatMap { $0 }

        if returnValues.isEmpty { return nil }
        return returnValues
    }
}
