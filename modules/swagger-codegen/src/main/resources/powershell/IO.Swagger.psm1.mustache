#region Import functions

$FunctionsToExport = @()
$Folders = 'Public', 'Private'

foreach ($Scope in $Folders) {
    Get-ChildItem -LiteralPath (
        Join-Path -Path $PSScriptRoot -ChildPath $Scope
    ) -File -Filter '*.ps1' | ForEach-Object {
        $File = $_
        try {
            Write-Verbose "Dotsourcing file: $File"
            . $File.FullName

            switch ($Scope) {
                'Public' {
                    $FunctionsToExport += $File.BaseName
                }
            }
        } catch {
            throw "Can't import functions from file: $File"
        }
    }
}

Export-ModuleMember -Function $FunctionsToExport

#endregion


#region Initialize APIs

{{#apiInfo}}
{{#apis}}
{{#operations}}
{{#operation}}
'Creating object: {{{packageName}}}.Api.{{{classname}}}' | Write-Verbose
$Script:{{{classname}}}= New-Object -TypeName {{{packageName}}}.Api.{{{classname}}} -ArgumentList @($null)

{{/operation}}
{{/operations}}
{{/apis}}
{{/apiInfo}}

#endregion
